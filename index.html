<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hevoskisat Clicker Challenge</title>
    <link rel="stylesheet" href="style.css">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üèá</text></svg>">
</head>
<body>

    <div id="game-container">
        <div class="top-bar">
            <h1>Hevoskisat Clicker Challenge</h1>
            <!-- Player management UI is RESTORED -->
            <div id="player-management">
                <select id="player-select"></select>
                <button id="add-player-button">Add Player</button>
            </div>
            <div class="top-buttons">
                <button id="new-game-button">New Game üöÄ</button>
                <button id="customize-toggle-button">Customize ‚öôÔ∏è</button>
            </div>
        </div>

        <div class="difficulty-settings">
            <h3>Difficulty</h3>
            <div class="difficulty-options">
                <label><input type="radio" name="difficulty" value="easy"> Easy</label>
                <label><input type="radio" name="difficulty" value="medium"> Medium</label>
                <label><input type="radio" name="difficulty" value="hard" checked> Hard</label>
                <label><input type="radio" name="difficulty" value="manual"> Manual</label>
            </div>
        </div>

        <div id="winner-announcement"></div>
        <div id="countdown-display">Add a player or press a key (W/Up Arrow) or Gamepad button to Join!</div>

        <div id="race-track">
            <!-- Player lanes will be added here by JS -->
        </div>

        <div id="controls">
            <!-- Player control groups will be added here by JS -->
        </div>

        <div id="log-container">
            <h2>Game Log</h2>
            <ul id="log-list"></ul>
        </div>
    </div>
    
    <!-- Modal Overlay (shared by all modals) -->
    <div id="modal-overlay" class="hidden"></div>

    <!-- Customize Modal -->
    <div id="customize-modal" class="hidden">
        <div class="modal-content">
            <button id="close-modal-button" class="close-button">√ó</button>
            <h2>Customize Game</h2>
            
            <div id="customize-player-list">
                <!-- Sections for each player's vehicle will be added here by JS -->
            </div>

            <div id="manual-controls" class="manual-controls-area">
                <h4>Advanced Settings (applies on New Game)</h4>
                <div class="settings-group">
                    <label for="increment-slider">Tap Power (<span id="increment-value-display">8</span>): </label>
                    <input type="range" id="increment-slider" min="5" max="25" value="8">
                </div>
                <div class="settings-group">
                    <label for="drain-rate-slider">Force Drain (<span id="drain-rate-value-display">0.7</span>): </label>
                    <input type="range" id="drain-rate-slider" min="1" max="10" value="7">
                </div>
                <div class="settings-group">
                    <label for="start-mode-select">Start Mode: </label>
                    <select id="start-mode-select">
                        <option value="single" selected>Perfect Start (Single Button)</option>
                        <option value="two">Perfect Start (Two Buttons)</option>
                        <option value="disabled">Disabled</option>
                    </select>
                </div>
                <div class="settings-group" id="false-start-penalty-group">
                    <label for="false-start-penalty-select">False Start Penalty: </label>
                    <select id="false-start-penalty-select">
                        <option value="stall" selected>Stall at Start</option>
                        <option value="none">Disabled</option>
                    </select>
                </div>
                <div class="settings-group" id="boost-slider-group">
                    <label for="boost-slider">Start Boost (<span id="boost-value-display">1.0</span>x width): </label>
                    <input type="range" id="boost-slider" min="5" max="20" value="10">
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="hidden">
        <div class="modal-content">
            <button id="close-help-button" class="close-button">√ó</button>
            <h2>How to Play</h2>
            <h3>Goal</h3>
            <p>Be the first player to get your vehicle across the finish line! üèÅ</p>
            <h3>Joining the Game</h3>
            <p>
                <ul>
                    <li><strong>Human Players:</strong> To join, simply press one of the default keyboard controls (<strong>W, Up Arrow, etc.</strong>) or any face button (<strong>A,B,X,Y / X,O,‚ñ°,‚ñ≥</strong>) on a connected gamepad. The first available player slot will be assigned to you.</li>
                    <li><strong>AI Players:</strong> Use the "Add Player" button to add a player slot. Then, go to the "Customize" menu (‚öôÔ∏è) to enable the "Bot AI" for that player.</li>
                </ul>
            </p>

            <h3>Starting the Race</h3>
            <p>A good start is crucial! After the countdown, the "GO!" signal will appear.
                <ul>
                    <li><strong>Perfect Start:</strong> Press your key(s) or any Gamepad face button right as "GO!" appears to get a starting boost.</li>
                    <li><strong>False Start:</strong> Pressing your key or button before "GO!" will cause you to stall for a moment after the race begins.</li>
                    <li><strong>Start Modes:</strong> You can choose between a single-button or two-button start for keyboard players in the advanced settings.</li>
                </ul>
            </p>

            <h3>Gameplay</h3>
            <p>Tap your assigned key(s), click your control area with the mouse, or tap any face button on your assigned gamepad to build force. The more force you have, the faster you move. But be careful, force drains over time!</p>
            <h3>Active Player Controls</h3>
            <div id="help-controls-list">
                <!-- Player controls will be listed here by JS -->
            </div>

            <div id="audio-controls">
                <h3>Audio Settings</h3>
                <div class="audio-setting-item">
                    <label for="volume-slider">Volume:</label>
                    <input type="range" id="volume-slider" min="0" max="1" step="0.01">
                    <button id="mute-button">üîä</button>
                </div>
            </div>

            <div id="about-section">
                <h3>About</h3>
                <p>Hevoskisat Clicker Challenge is a fast-paced, competitive multiplayer tapping game. Tap your keys to charge force and race your chosen character to the finish line. First to cross wins! Made in pure HTML5, CSS3, and JavaScript.</p>
            </div>
        </div>
    </div>

    <div id="help-prompt">Press H key for Help</div>

    <script src="script.js"></script>
</body>
</html>
